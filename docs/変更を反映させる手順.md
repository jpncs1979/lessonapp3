# 変更を反映させる手順

「Local: http://localhost:3000 も見れない」「本番アプリも何の変化もない」ときの確認手順です。

---

## ローカル（自分のパソコン）で変更を見る

### 1. 開発サーバーを起動する

1. **Cursor** でこのプロジェクト（lessonapp3）を開いた状態にする  
2. メニューから **ターミナル** → **新しいターミナル** を開く  
3. 次のコマンドを入力して Enter を押す  

   ```  
   npm run dev  
   ```

4. 数十秒待つと、ターミナルに次のような表示が出ます  

   ```  
   ▲ Next.js 16.x.x  
   - Local: http://localhost:3000  
   ```  

   「Local: http://localhost:3000」と出ていれば起動できています。

### 2. ブラウザで開く

1. ブラウザ（Chrome など）を開く  
2. アドレス欄に **http://localhost:3000** と入力して Enter  
3. 名前を選択して入る画面が表示されれば OK  

**注意**

- 「Local: http://localhost:3000」がターミナルに出るまで待ってからブラウザで開く  
- ターミナルを閉じるとサーバーが止まるので、**ターミナルは閉じない**  
- 変更したあと画面が変わらないときは、ブラウザで **F5** または **Ctrl + R** で再読み込みする  

---

## 本番アプリ（Vercel の URL）で変更を見る

本番のサイト（例: https://lessonapp3.vercel.app）は、**GitHub に push した内容**を Vercel が自動でデプロイして表示しています。  
コードを変えても **GitHub に push していないと、本番には反映されません。**

### 1. 変更を GitHub に送る

1. Cursor で **ターミナル** を開く（プロジェクトのフォルダにいる状態で）  
2. 次の3つを **1行ずつ** 実行する  

   ```  
   git add .  
   git commit -m "名前だけログインなど変更"  
   git push  
   ```

3. エラーが出ずに完了すれば、GitHub に送れています  

### 2. Vercel のデプロイを待つ

- push すると、Vercel が自動で「再デプロイ」を始めます  
- 数十秒〜1分ほどで完了します  
- Vercel のダッシュボード（vercel.com）の **Deployments** で、一番上が「Ready」になっていれば完了  

### 3. 本番の URL で確認する

1. ブラウザで **https://lessonapp3.vercel.app**（あなたの本番 URL）を開く  
2. **Ctrl + Shift + R**（Mac は **Cmd + Shift + R**）で「スーパーリロード」する  
   - キャッシュを無視して最新のサイトを読み込みます  
3. 名前を選んで「ログイン」など、変更した動きになっているか確認する  

**まだ変わらないとき**

- もう 1〜2 分待ってから、もう一度スーパーリロードする  
- Vercel の **Deployments** で、いちばん上のデプロイが「Ready」で、**時刻が push したあと**になっているか確認する  

---

## 「何も変わっていない」ときの確認リスト

本番（https://lessonapp3.vercel.app）を開いても、変更したつもりなのに動きが同じ場合、次を **上から順に** 確認してください。

### 1. もう一度 push する

ターミナルでプロジェクトのフォルダに移動し、次を実行する。

```  
git push origin master  
```

「Already up to date」と出れば、すでに GitHub には送れています。  
エラーが出た場合は、そのメッセージを確認する（GitHub にログインしていない、など）。

### 2. Vercel でデプロイが走っているか見る

1. ブラウザで **https://vercel.com** を開き、ログインする  
2. **lessonapp3**（このアプリ）のプロジェクトを開く  
3. 上方的な **Deployments** タブをクリックする  
4. いちばん上にあるデプロイの **時刻** を確認する  
   - いま **push した直後よりあと** の時刻なら、最新のコードでデプロイされています  
   - 時刻が **push より前** のままなら、「Redeploy」を手動で実行する  
     - いちばん上のデプロイの右側の **⋯** をクリック → **Redeploy** を選ぶ → **Redeploy** で実行  

### 3. 「新しい画面」かどうか見分ける

- **新しいコード** が読まれている場合：  
  - **最初の画面**に「名前を選択して入る」「新規登録」の **2つのボタンだけ** 出て、その下に小さく「最初の画面：2つのボタンのみ」と出る。  
  - **名前を選択して入る** を押すと「名前を選択して入る」画面になり、名前を選んで「この名前でログイン」を押すと、**同じ画面にメール・パスワード欄は出ない**（セッションがなければ「ログイン画面へ」だけ出る）。画面に小さく「名前選択のみ・メール欄は出ません」と出る。  
- **古いコード** のままの場合：  
  - 最初から「名前を選択」の説明と名前のドロップダウンが1つのカードに出る、または名前を選ぶと **同じ画面にメール・パスワード入力欄** が出る。

「新しい画面」の表示になっていない ＝ **読込先がまだ古い**（デプロイ前のビルドや別URLの可能性あり）。

### 4. ブラウザのキャッシュを外して開き直す

1. 本番の URL（https://lessonapp3.vercel.app）を開く  
2. **Ctrl + Shift + R**（Mac は **Cmd + Shift + R**）で **スーパーリロード**  
3. シークレットでも同じなら、**読込先・デプロイ** を疑う（下記 5 と 6）

### 5. ローカルで確実に最新コードを読ませる

**自分のパソコン** で「今のリポジトリのコード」がどう動くか確認する。

1. ターミナルで **`npm run dev`** を実行する  
2. ブラウザで **http://localhost:3000** を開く（本番 URL ではなく **localhost**）  
3. 最初の画面に「最初の画面：2つのボタンのみ」と出るか、名前選択画面に「名前選択のみ・メール欄は出ません」と出るか確認する  

- **localhost で新しい表示になる** → コードは新しい。本番だけ古い ＝ **Vercel のデプロイ元・キャッシュ・読込先** を確認（次の 6）。  
- **localhost でも古い表示** → 保存やビルドが反映されていない。Cursor でファイルを保存し直し、ターミナルで `npm run dev` を一度止めて（Ctrl+C）もう一度 `npm run dev` する。

### 6. Vercel の「読込先」とキャッシュを確認する

- **見ている URL** が本当にこのプロジェクトの本番 URL か確認する（別プロジェクトやプレビューURLのままにしていないか）。  
- Vercel の **Deployments** で、**最新のデプロイ** を「Redeploy」する。そのとき **「Clear build cache and redeploy」**（キャッシュをクリアして再デプロイ）があれば、それで実行する。  
- デプロイ完了後、**本番の URL だけ** を開き直し、スーパーリロード（Ctrl+Shift+R）する。

ここまでやっても本番だけ古い場合は、Vercel の設定（Production Branch が master か、など）を確認する。

---

## まとめ

| 見たい場所       | やること |
|------------------|----------|
| ローカル         | ターミナルで `npm run dev` → ブラウザで http://localhost:3000 を開く |
| 本番（Vercel）   | `git add .` → `git commit -m "..."` → `git push` → 1分待つ → 本番 URL をスーパーリロード |
